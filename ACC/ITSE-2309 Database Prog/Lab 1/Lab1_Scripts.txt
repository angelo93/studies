-- Michael Navarro
-- Lab 1 ITSE2309

-- Problem #1
SELECT *
 FROM STOCK;

-- Problem #2
SELECT LNAME, FNAME, COMPANY
 FROM CUSTOMER
ORDER BY COMPANY;

-- Problem #3
SELECT COMPANY
 FROM CUSTOMER
 WHERE CITY IN ('Sunnyvale', 'Redwood City', 'San Francisco');

-- Problem #4
SELECT ORDER_NUM, ORDER_DATE, CUSTOMER_NUM, SHIP_DATE, PAID_DATE
 FROM ORDERS
 WHERE ORDER_DATE BETWEEN '31-DEC-1999' AND '03-JAN-2000';

-- Problem #5
SELECT ORDER_NUM, ORDER_DATE, SHIP_CHARGE
 FROM ORDERS
 WHERE SHIP_CHARGE > 15
  AND BACKLOG = 'n';

-- Problem #6
SELECT *
 FROM STOCK
 WHERE DESCRIPTION LIKE 'base%'
  AND MANU_CODE LIKE 'H%'
  AND UNIT_PRICE > 200;

-- Problem #7
SELECT DISTINCT COMPANY
 FROM CUSTOMER, ORDERS
 WHERE ORDERS.CUSTOMER_NUM = CUSTOMER.CUSTOMER_NUM;

-- Problem #8
SELECT DISTINCT ORDERS.CUSTOMER_NUM, STOCK.DESCRIPTION
 FROM ORDERS, ITEMS, STOCK
 WHERE ORDERS.CUSTOMER_NUM BETWEEN 104 AND 108
  AND ORDERS.ORDER_NUM = ITEMS.ORDER_NUM
  AND ITEMS.STOCK_NUM = STOCK.STOCK_NUM
ORDER BY ORDERS.CUSTOMER_NUM ASC, DESCRIPTION ASC;

-- Problem #9
SELECT COUNT (DISTINCT CUSTOMER_NUM) as Total_Customers_with_Orders
 FROM ORDERS;

-- Problem #10
SELECT ORDERS.CUSTOMER_NUM, COUNT(DISTINCT ORDERS.ORDER_NUM) as NUMBER_OF_ORDERS, SUM(ITEMS.QUANTITY) as TOTAL_QUANTITY_OF_ITEMS, SUM(ITEMS.TOTAL_PRICE) as TOTAL_PRICE
 FROM ORDERS, ITEMS
 WHERE ORDERS.ORDER_NUM = ITEMS.ORDER_NUM
 GROUP BY CUSTOMER_NUM
ORDER BY ORDERS.CUSTOMER_NUM;